# Move fast and Build thingsâ„¢ï¸

<p>
  <a href="https://aetherspace-green-stack-starter.vercel.app/">
    <img alt="Supports Next.js" longdesc="Supports Next.js" src="https://img.shields.io/badge/Next-black?style=for-the-badge&logo=next.js&logoColor=white" />
  </a>
  <a href="https://aetherspace-green-stack-starter.vercel.app/">
    <img alt="Supports Vercel Deployments" longdesc="Supports Vercel Deployments" src="https://img.shields.io/badge/vercel-%23000000.svg?style=for-the-badge&logo=vercel&logoColor=white" />
  </a>
  <a href="https://aetherspace-green-stack-starter.netlify.app/">
    <img alt="Supports Netlify Deployments" longdesc="Supports Netlify Deployments" src="https://img.shields.io/badge/netlify-%23000000.svg?style=for-the-badge&logo=netlify&logoColor=#00C7B7" />
  </a>
  <a href="https://expo.dev/@thorrstevens/aetherspace-starter-app?serviceType=classic&distribution=expo-go&release-channel=starter-preview-main">
    <img alt="Test in Expo GO" longdesc="Test in Expo GO" src="https://img.shields.io/badge/expo-1C1E24?style=for-the-badge&logo=expo&logoColor=#D04A37" />
  </a>
  <a href="https://expo.dev/@thorrstevens/aetherspace-starter-app?serviceType=classic&distribution=expo-go&release-channel=starter-preview-main">
    <img alt="Supports Expo iOS" longdesc="Supports Expo iOS" src="https://img.shields.io/badge/iOS-4630EB.svg?style=for-the-badge&logo=APPLE&labelColor=999999&logoColor=fff" />
  </a>
  <a href="https://expo.dev/@thorrstevens/aetherspace-starter-app?serviceType=classic&distribution=expo-go&release-channel=starter-preview-main">
    <img alt="Supports Expo Android" longdesc="Supports Expo Android" src="https://img.shields.io/badge/Android-4630EB.svg?style=for-the-badge&logo=ANDROID&labelColor=A4C639&logoColor=fff" />
  </a>
  <a href="https://main--62c9a236ee16e6611d719e94.chromatic.com/?path=/story/readme-md--page">
    <img alt="Docs with Storybook" longdesc="Documentated with Storybook" src="https://img.shields.io/badge/-Storybook-FF4785?style=for-the-badge&logo=storybook&logoColor=fff" />
  </a>
</p>

> This project was bootstrapped with [Aetherspace](https://github.com/Aetherspace/green-stack-starter), the Evergreen repo setup for all your full-stack cross platform app development needs \{...ğŸ’š\} Enabling the project to be built for Web, iOS, Android, PWA, Static, SSR, REST and GraphQL all at once ğŸ‘‡

### Getting Started âš¡ï¸

Install packages: `yarn install`

Run on web & mobile: `yarn dev`

Run with Storybook docs: `yarn dev-docs`

---

<details>
  <summary><b>âœ… Aetherspace, GREEN stack & Template Benefits? ğŸš€</b></summary>

---

# Aetherspace - GREEN stack starter template for cross platform React app development

### Table of contents

ğŸ’š - [What is the GREEN stack?](#what-is-the-green-stack)  
ğŸš€ - [What is Aetherspace?](#what-is-aetherspace)  
ğŸ¤– - [Why start with a turbo/monorepo?](#why-turborepo)  
ğŸ“ - [File structure and installing new packages.](#package-management)  
ğŸ‘¾ - [Benefits and next steps.](#benefits-next-steps)  
ğŸ¤·â€â™‚ï¸ - [When _not_ to use the GREEN stack.](#when-not-to-use-green-stack)  
ğŸ“š - [Relevant Docs.](#relevant-docs)

## What the hell is the GREEN stack? ğŸ’š <a name="what-is-the-green-stack"></a>

In short GREEN stands for these 5 core technologies:

- **G**raphQL for typed and self documenting APIs
- **R**eact-Native and React-Native-Web for write-once UI
- **E**vergreen components (extendable, themable, accessible, with docs & tests)
- **E**xpo for easy web + mobile dev, deploys and testing
- **N**ext.js for SEO, Static Exports, API, SSR & Web-Vitals

The core idea this tech stack enables you to achieve boils down to writing your app code or features once with Javascript and React, yet make it available on any platform or device without double implementations or the need for different development teams.

### It allows you to move fast, save time and deliver more ğŸ‰

> Think of it as Unity for React Apps. Just like Unity aims to make cross console game development a lot easier for (indie) game devs, the GREEN stack aims to do the same for cross-platform app development.

## How does 'Aetherspace' help, exactly? ğŸš€ <a name="what-is-aetherspace"></a>

Aetherspace is an opinionated framework that fills in the gaps of working and building with the GREEN stack:

- How should I handle responsive design?
- How do I avoid SSR layout shift when react-native styling does not support media queries or classnames?
- How can I expose / read public env vars across multiple platforms?
- Wait, how do I take advantage of next/image on the web when that's not available in React-Native?
- What's the best way to style and animate my UI elements for both web and mobile?

Just to name a few.

While the stack itself is very powerful, figuring out how to get set up and do certain things in a write-once way can be frustrating and time consuming. To save you time figuring it all out on your own, _Aetherspace_ contains a bunch of packages, utils and best-practices to set you up for a free and easy ride to cross-platform success.

> Aetherspace is also fully optional. Usage of the UI primitives, React hooks and JS utils provided by `packages/aetherspace` is recommended but not required.

> Provided you throw out the examples and edit some helper scripts in the `package.json` files, you could even delete the package entirely and still be left with a great GREEN stack starter.

More on Aetherspace in the **[ğŸ‘¾ Benefits and Next steps](#benefits-next-steps)** section or `AETHERSPACE.md` and `CODEGEN.md`.

## But why start with a turbo/monorepo? ğŸ¤– <a name="why-turborepo"></a>

One very annoying thing about figuring stuff out on your own is when packages you're using require custom configuration for webpack, babel or otherwise. It often happens that updating e.g. a single `babel.config.js` used for both React-Native and Next.js will fix usage on either, but then break the other.

Using a monorepo with different entry points for Next.js and Expo allows us to keep configs more seperate, and therefore allow more confident updating of packages and configs without accidentally breaking other platforms.

In this starter template, we've opted to use turborepo with yarn workspaces. We'll list some basics in the next section, but for a deeper understanding please refer to their documentation for more info.

## ğŸ“ File structure and package management ğŸ“¦ <a name="package-management"></a>

This starter monorepo has three types of workspaces:

- `/apps/*` for all expo & next.js versions of your apps (consumes `'features'` ğŸ‘‡)
- `/features/*` features of your app, grouped together by feature name (consumes `'packages'` ğŸ‘‡)
- `/packages/*` for all shared dependencies / library code used in multiple apps

```
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ expo/ ğŸ‘‰ Where all Expo & mobile specific config for {app-name} lives
â”‚       â””â”€â”€ app.json â¡ï¸ Expo app config (e.g. landscape / tablet support)
â”‚       â””â”€â”€ App.tsx â¡ï¸ Mobile Entrypoint & Navigation Setup (using 'app-core/screens/')
â”‚       â””â”€â”€ babel.config.js â¡ï¸ Babel transpilation config for Expo
â”‚       â””â”€â”€ index.js â¡ï¸ Mobile entrypoint loader for App.tsx
â”‚       â””â”€â”€ metro.config.js â¡ï¸ Metro bundler config for react-native
â”‚       â””â”€â”€ package.json â¡ï¸ yarn-workspace config, lists expo & non-next.js dependencies
â”‚       â””â”€â”€ tsconfig.json â¡ï¸ Typescript config for Expo
â”‚       â””â”€â”€ webpack.config.js â¡ï¸ Enables PWA browser testing with Expo (no SSR)
â”‚
â”‚   â””â”€â”€ next/ ğŸ‘‰ Where all Next.js, Server & API config for {app-name} lives
â”‚       â””â”€â”€ public/ â¡ï¸ favicon, app icons & other static assets (e.g. images & fonts)
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ pages/ â¡ï¸ directory based routes (using 'app-core/screens/')
â”‚               â””â”€â”€ api/ â¡ï¸ directory based api routes (using 'app-core/resolvers/')
â”‚                   â””â”€â”€ graphql.ts â¡ï¸ GraphQL client from 'app-core/graphql/'
â”‚               â””â”€â”€ _app.tsx â¡ï¸ App Layout Wrapper (e.g. headers / footers / navigation)
â”‚               â””â”€â”€ _document.tsx â¡ï¸ HTML wrapper for head, body & meta tags (+ SSR styles)
â”‚               â””â”€â”€ index.tsx â¡ï¸ Homepage (e.g. using 'app-core/screens/HomeScreen.tsx')
â”‚       â””â”€â”€ babel.config.js â¡ï¸ Babel transpilation config for Next.js
â”‚       â””â”€â”€ next.config.js â¡ï¸ Next.js config, modules to transpile & plugins to support
â”‚       â””â”€â”€ package.json â¡ï¸ yarn-workspaces config, lists ONLY next.js dependencies
â”‚       â””â”€â”€ tsconfig.json â¡ï¸ Typescript config for Next.js
|
|â”€â”€ features/
â”‚   â””â”€â”€ app-core/ ğŸ‘‰ Where all cross-platform code for {app-name} lives
â”‚       â””â”€â”€ components/ â¡ï¸ Molecules / Atoms / Common UI used in 'screens/'
â”‚       â””â”€â”€ graphql/ â¡ï¸ Shared code for the GraphQL API client (optional)
â”‚       â””â”€â”€ resolvers/ â¡ï¸ Shared resolvers used in both REST or GraphQL API
â”‚       â””â”€â”€ screens/ â¡ï¸ Page templates used in App.tsx and next.js's 'pages/' directory
â”‚       â””â”€â”€ package.json â¡ï¸ config required by yarn-workspaces, no dependencies
â”‚   â””â”€â”€ {app-feature}/ ğŸ‘‰ Code shared across apps, ideally same structure as 'features/app-core'
â”‚       â””â”€â”€ package.json â¡ï¸ config required by yarn-workspaces, no dependencies
â”‚
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ @aetherspace/ â¡ï¸ Primitives, utils & helpers for working with the GREEN stack
â”‚   â””â”€â”€ @config/ â¡ï¸ list of ts & other configs to use / extend from in next or expo apps
â”‚   â””â”€â”€ @scripts/ â¡ï¸ scripts that help streamline things like codegen & managing assets
â”‚   â””â”€â”€ {comp-lib}/ ğŸ‘‰ Code shared across apps, ideally same structure as 'features/app-core'
â”‚       â””â”€â”€ package.json â¡ï¸ yarn-workspace config, doesn't need deps unless published
â”‚
â”œâ”€â”€ node_modules/ â¡ï¸ Contains all modules for this monorepo
â””â”€â”€ package.json  â¡ï¸ Root yarn-workspaces configuration + helper scripts, no deps
```

```
ğŸ’¡ `{app-feature}`, `{app-name}` & `{comp-lib}` are just placeholders and you **can** have multiple of these
```

#### ğŸ“¦ Keep your apps seperate with `/apps/*` & `/features/*` workspaces:

For every app you're building in this monorepo, you'll need a few folders:

- `/features/{app}-core` - Where most of your core app specific UI, logic and screens will live.
  Shouldn't have any dependencies.
- `/apps/next` - Entry for web where only next.js related config/setup for an app should live.
  Should list only next.js related dependencies & polyfills.
- `/apps/expo` - Entry for mobile where only expo related config/setup for an app should live.
  Should list all react(-native) and non next.js related dependencies.

In each of these folders own `package.json` file, a `name` property should be specified to identify that workspace. This name can then be referenced during installs via e.g.

```bash
yarn workspace next add next-images
```

```bash
yarn workspace expo add moti
```

<details>
<summary>ğŸ’¡ `/packages/*` workspaces for e.g. component libraries</summary>

#### Write shared library code in `/packages/*` workspaces:

Packages aim to provide common building blocks or logic for both apps _and_ other packages. They do not need to differentiate between entry points with `/packages/...-next` and `/packages/...-expo`.

Like `/apps/` workspaces, they do also require their own `package.json` and `name`, and installing dependencies can work exactly the same:

```bash
yarn workspace component-library add -D @types/react
```

However, unless you will be publishing the package to NPM, it may be best to just install any dependencies in the consuming apps' `/apps/next`, `/apps/expo` or `/features/{app-feature}` workspace instead.

> A good example of a library package usable by multiple app workspaces in this monorepo is the
> `/packages/aetherspace` workspace. It contains UI primitives like `AetherView`, `AetherImage` & `AetherLink` that are small wrappers for & recommended over react-native's own `View`, `Text` & `Image` components.

</details>

## ğŸ‘¾ Stack and Template benefits + Next steps ğŸ‘¾ <a name="benefits-next-steps"></a>

If you've read the sections above, It's likely the **ease** of use, **time saving** capabilities and **scalability** of this stack & template are clear.

The starter repo comes with some opinionated extra packages and abilities.  
Here's a list of what you can start doing out of the box:

- Link pages and screens cross platform with `expo-next-react-navigation` or `<AetherLink>`
- Use tailwind to style UI responsively on web / mobile with `<AetherView tw="sm:px-2">` / `tailwind-rn`
- Animate UI elements with `react-native-reanimated` or `moti`
- Add illustrations or icons with `react-native-svg`
- Bring the power of GraphQL to JSON or REST apis with `aetherResolver()` and Schemas.
- Add auth with [AuthSession](https://docs.expo.dev/versions/latest/sdk/auth-session/) ([Expo Examples](https://docs.expo.dev/guides/authentication/))
- Document your components and APIs with Storybook.
- Deploy to vercel with `yarn deploy` or `vercel --prod --no-clipboard` ([view live](https://aetherspace-green-stack-starter.vercel.app/))
- Deploy to netlify [via this guide](https://www.netlify.com/blog/2020/11/30/how-to-deploy-next.js-sites-to-netlify/) ([view live](https://aetherspace-green-stack-starter.netlify.app/))

If you'd like to continue learning about Aetherspace and the GREEN stack, there are more detailed guides, tips and best-practices in:

- `AETHERSPACE.md`, `CODEGEN.md`, `NAVIGATION.md` & `API.md` (Aetherspace & Codegen)
- `STYLING.md`, `ANIMATING.md` & `DOCUMENTING.md` (GREEN stack How-tos)

## ğŸ’¼ Why this makes sense from a business perspective ğŸ’¸ <a name="why-this-makes-sense-from-a-business-perspective"></a>

Whether you're a startup or established company, having both web and mobile apps is a great competitive advantage. There are many stories of market leaders suddenly being overtaken because the competition were able to move faster or had more devices their solution was available on for their customers.

This stack makes it near effortless to enable extra platforms. It helps keep teams small and enables them to move fast when building new pages or features for phones, tablets and/or the web.

**More deliverables for less time invested in turn means flexibility in one or more of these areas:**

- ... negotiation room about budget or deadlines (in case of client work)
- ... ğŸ’° to be distributed among the entire team
- ... ğŸ•— available for experimentation
- ... budget available to market the product

<details>
<summary>Show full ğŸ•—ğŸ•— to ğŸ’°ğŸ’°ğŸ’° Comparison</summary>

---

Let's talk Return on Investment:

> ğŸ•— = time required = devs / teams / resources invested  
> ğŸ’° = deliverable sale value = costs to build + profit margin  
> ROI = ğŸ•— -> _sold for_ -> ğŸ’°

Web only project ROI = ğŸ•—ğŸ•— -> ğŸ’°ğŸ’°

- ğŸ•— Web Front-End ğŸ’°
- ğŸ•— General Back-End (REST / GraphQL + Templates / SSR) ğŸ’°

Native iOS + Android project ROI = ğŸ•—ğŸ•—ğŸ•— -> ğŸ’°ğŸ’°ğŸ’°

- ğŸ•— iOS App with Swift ğŸ’°
- ğŸ•— Android app with Java ğŸ’°
- ğŸ•— API Back-End (REST / GraphQL) ğŸ’°

React-Native Mobile App ROI = ğŸ•—ğŸ•— -> ğŸ’°ğŸ’° to ğŸ’°ğŸ’°ğŸ’°

- ğŸ•— iOS + Android App with RN ğŸ’°(ğŸ’°)
- ğŸ•— API Back-End (REST / GraphQL) ğŸ’°

Expo Mobile + PWA ROI = ğŸ•—ğŸ•— ->ğŸ’°ğŸ’° to ğŸ’°ğŸ’°ğŸ’°ğŸ’°

- ğŸ•— iOS + Android + PWA with Expo & RN (Web without SSR) ğŸ’°(ğŸ’°ğŸ’°)
- ğŸ•— API Back-End (REST / GraphQL) ğŸ’°

> Now, things get _really_ interesting when you try to compare full cross-platform apps

Full Cross Platform with Separate Dev Teams ROI = ğŸ•—ğŸ•—ğŸ•—ğŸ•—ğŸ•—ğŸ•—ğŸ•—Â ->Â ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°

- ğŸ•— Web Front-End ğŸ’°
- ğŸ•— iOS App with Swift ğŸ’°
- ğŸ•— Android app with Java ğŸ’°
- ğŸ•— Windows App Dev Team ğŸ’°
- ğŸ•— MacOS App Dev Team ğŸ’°
- ğŸ•— Linux App Dev Team ğŸ’°
- ğŸ•— API Back-End (REST / GraphQL) ğŸ’°

Full Cross Platform with GREEN stack ROI = ğŸ•—ğŸ•—Â -> ğŸ’°ğŸ’° to ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°

- ğŸ•— Web (PWA & SSR & Web Vitals) + iOS + Android + Windows + MacOS + Linux ğŸ’°(ğŸ’°ğŸ’°ğŸ’°ğŸ’°ğŸ’°)
- ğŸ•— Back-End (REST + GraphQL + SSR + Static Exports + ISSG + universal JS utils thanks to Next.js) ğŸ’°

#### Key takeaway: Always upsell more plaforms / devices the app could run on

---

</details>

## When not to use the GREEN stack? ğŸ¤·â€â™‚ï¸ <a name="when-not-to-use-green-stack"></a>

The GREEN stack is unlikely to be the best fit when your project...

- ... will always be web only ğŸ‘‰ Use `next.js`
- ... will always be mobile only ğŸ‘‰ Use `Expo`
- ... will always be desktop only ğŸ‘‰ Use `Electron` + `React` / `Vue` / `Svelte`
- ... is very Bluetooth / AR / VR / XR heavy ğŸ‘‰ Go native with `Swift` / `Java`
- ... is a console game ğŸ‘‰ Use [`Unity`](https://unity.com/download) instead
- ... is not using React ğŸ‘‰ Use `Svelte` / `Vue` + `Ionic`
- ... has no real need for Server Rendering, SEO or Web-Vitals ğŸ‘‰ Use `Expo` (+ Web Support)
- ... is using React, but the project is too far along and has no budget, time or people to refactor ğŸ¤·â€â™‚ï¸

If your project has required dependencies / SDKs / libraries that are either not available in JS, are not extractable to API calls or cannot function cross-platform, this may also not be a good solution for your use-case\*.

```
ğŸ›  * However, for JS libs, you could always try adding cross platform support yourself with `patch-package`
```

## ğŸ“š Relevant docs: <a name="relevant-docs"></a>

- [Yan Workspaces Docs](https://classic.yarnpkg.com/lang/en/docs/workspaces/)
- [Turborepo Docs](https://turborepo.org/docs)
- [Expo Docs](https://docs.expo.dev/)
- [Next.js Docs](https://nextjs.org/docs/getting-started)
- [React Native Docs](https://reactnative.dev/docs/getting-started)
- [React Navigation Docs](https://reactnavigation.org/docs/getting-started)
- [React-Native-Web Docs](https://necolas.github.io/react-native-web/docs/)
- [Apollo GraphQL Docs](https://www.apollographql.com/docs/)
- [Reanimated Docs](https://docs.swmansion.com/react-native-reanimated/docs)
- [Moti Docs](https://moti.fyi/)

</details>

---
